
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>scAVENGERS cluster: demultiplexing scATAC-seq data &#8212; scAVENGERS 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="scavengers-cluster-demultiplexing-scatac-seq-data">
<h1>scAVENGERS cluster: demultiplexing scATAC-seq data<a class="headerlink" href="#scavengers-cluster-demultiplexing-scatac-seq-data" title="Permalink to this heading">¶</a></h1>
<p>Given reference and alternate allele count matrices generated by vartrix in mtx format, scAVENGERS cluster demultiplexes cell barcodes into each donor in unsupervised manner.</p>
<section id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">¶</a></h2>
<p>scAVENGERS cluster provides cluster assignment results in a tab-seperated format.</p>
<p>Unless <code class="docutils literal notranslate"><span class="pre">-o</span></code> option is not specified, the results are written into stdout. So, to save demultiplexing results to certain file, you may either run:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Strategy 1: specifying -o option</span>
<span class="n">scAVENGERS</span> <span class="n">cluster</span> <span class="o">-</span><span class="n">r</span> <span class="n">ref</span><span class="o">.</span><span class="n">mtx</span> <span class="o">-</span><span class="n">a</span> <span class="n">alt</span><span class="o">.</span><span class="n">mtx</span> <span class="o">-</span><span class="n">b</span> <span class="n">barcodes</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">o</span> <span class="n">clusters_tmp</span><span class="o">.</span><span class="n">tsv</span>

<span class="c1"># Strategy 2: redirecting the output</span>
<span class="n">scAVENGERS</span> <span class="n">cluster</span> <span class="o">-</span><span class="n">r</span> <span class="n">ref</span><span class="o">.</span><span class="n">mtx</span> <span class="o">-</span><span class="n">a</span> <span class="n">alt</span><span class="o">.</span><span class="n">mtx</span> <span class="o">-</span><span class="n">b</span> <span class="n">barcodes</span><span class="o">.</span><span class="n">txt</span> <span class="o">&gt;</span> <span class="n">clusters_tmp</span><span class="o">.</span><span class="n">tsv</span>
</pre></div>
</div>
<p>Because scAVENGERS cluster does not perform doublet detection, excluding doublet barcodes before or after running scAVENGERS cluster is required. To note, the output of scAVENGERS is compatible to troublet in souporcell pipeline, so you can use troublet to detect doublets after demultiplexing.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># Strategy 1: Filtering out doublet barcodes after running doublet detection tools
cat clusters_tmp.tsv | LC_ALL=C grep -F -f $SINGLET_BARCODES &gt; clusters.tsv

# Strategy 2: Using troublet as doublet detection tool
$TROUBLET_DIR/troublet -r ref.mtx -a alt.mtx --clusters clusters_tmp.tsv &gt; clusters.tsv
</pre></div>
</div>
</section>
<section id="parameters">
<h2>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">scAVENGERS</span><span class="o">/</span><span class="n">scAVENGERS</span> <span class="n">cluster</span> <span class="o">--</span><span class="n">help</span>
<span class="n">usage</span><span class="p">:</span> <span class="n">cluster</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="o">-</span><span class="n">r</span> <span class="n">REF</span> <span class="o">-</span><span class="n">a</span> <span class="n">ALT</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span> <span class="n">VCF</span><span class="p">]</span> <span class="o">-</span><span class="n">b</span> <span class="n">BARCODES</span> <span class="o">-</span><span class="n">o</span> <span class="n">OUTPUT</span> <span class="o">-</span><span class="n">k</span> <span class="n">CLUSTERS</span> <span class="p">[</span><span class="o">--</span><span class="n">priors</span> <span class="n">PRIORS</span> <span class="p">[</span><span class="n">PRIORS</span> <span class="o">...</span><span class="p">]]</span> <span class="p">[</span><span class="o">--</span><span class="n">ploidy</span> <span class="n">PLOIDY</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">err_rate</span> <span class="n">ERR_RATE</span><span class="p">]</span>
                  <span class="p">[</span><span class="o">--</span><span class="n">stop_criterion</span> <span class="n">STOP_CRITERION</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">max_iter</span> <span class="n">MAX_ITER</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">t</span> <span class="n">THREADS</span><span class="p">]</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="p">:</span>
  <span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>            <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="ow">and</span> <span class="n">exit</span>
  <span class="o">-</span><span class="n">r</span> <span class="n">REF</span><span class="p">,</span> <span class="o">--</span><span class="n">ref</span> <span class="n">REF</span>     <span class="n">Reference</span> <span class="n">allele</span> <span class="n">count</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">mtx</span> <span class="nb">format</span>
  <span class="o">-</span><span class="n">a</span> <span class="n">ALT</span><span class="p">,</span> <span class="o">--</span><span class="n">alt</span> <span class="n">ALT</span>     <span class="n">Alternate</span> <span class="n">allele</span> <span class="n">count</span> <span class="n">matrix</span> <span class="ow">in</span> <span class="n">mtx</span> <span class="nb">format</span>
  <span class="o">-</span><span class="n">v</span> <span class="n">VCF</span><span class="p">,</span> <span class="o">--</span><span class="n">vcf</span> <span class="n">VCF</span>     <span class="n">Vcf</span> <span class="n">file</span>
  <span class="o">-</span><span class="n">b</span> <span class="n">BARCODES</span><span class="p">,</span> <span class="o">--</span><span class="n">barcodes</span> <span class="n">BARCODES</span>
                        <span class="n">Line</span><span class="o">-</span><span class="n">seperated</span> <span class="n">text</span> <span class="n">file</span> <span class="n">of</span> <span class="n">barcode</span> <span class="n">sequences</span>
  <span class="o">-</span><span class="n">o</span> <span class="n">OUTPUT</span><span class="p">,</span> <span class="o">--</span><span class="n">output</span> <span class="n">OUTPUT</span>
                        <span class="n">Output</span> <span class="n">directory</span><span class="o">.</span>
  <span class="o">-</span><span class="n">k</span> <span class="n">CLUSTERS</span><span class="p">,</span> <span class="o">--</span><span class="n">clusters</span> <span class="n">CLUSTERS</span>
                        <span class="n">Number</span> <span class="n">of</span> <span class="n">donors</span><span class="o">.</span>
  <span class="o">--</span><span class="n">priors</span> <span class="n">PRIORS</span> <span class="p">[</span><span class="n">PRIORS</span> <span class="o">...</span><span class="p">]</span>
                        <span class="n">Number</span> <span class="ow">or</span> <span class="n">proportion</span> <span class="n">of</span> <span class="n">cells</span> <span class="ow">in</span> <span class="n">each</span> <span class="n">genotype</span><span class="o">.</span>
  <span class="o">--</span><span class="n">ploidy</span> <span class="n">PLOIDY</span>       <span class="n">Ploidy</span><span class="o">.</span> <span class="n">Defaults</span> <span class="n">to</span> <span class="mf">2.</span>
  <span class="o">--</span><span class="n">err_rate</span> <span class="n">ERR_RATE</span>   <span class="n">Baseline</span> <span class="n">probability</span><span class="o">.</span> <span class="n">DO</span> <span class="n">NOT</span> <span class="nb">set</span> <span class="n">this</span> <span class="n">parameter</span> <span class="n">zero</span><span class="p">,</span> <span class="n">because</span> <span class="n">it</span> <span class="n">leads</span> <span class="n">to</span> <span class="n">log</span><span class="o">-</span><span class="n">zeros</span><span class="o">.</span> <span class="n">Defaults</span> <span class="n">to</span> <span class="mf">0.001</span><span class="o">.</span>
  <span class="o">--</span><span class="n">stop_criterion</span> <span class="n">STOP_CRITERION</span>
                        <span class="n">log</span> <span class="n">likelihood</span> <span class="n">change</span> <span class="n">to</span> <span class="n">define</span> <span class="n">convergence</span> <span class="k">for</span> <span class="n">EM</span> <span class="n">algorithm</span>
  <span class="o">--</span><span class="n">max_iter</span> <span class="n">MAX_ITER</span>   <span class="n">number</span> <span class="n">of</span> <span class="n">maximum</span> <span class="n">iterations</span> <span class="k">for</span> <span class="n">a</span> <span class="n">temperature</span> <span class="n">step</span>
  <span class="o">-</span><span class="n">t</span> <span class="n">THREADS</span><span class="p">,</span> <span class="o">--</span><span class="n">threads</span> <span class="n">THREADS</span>
                        <span class="n">number</span> <span class="n">of</span> <span class="n">threads</span>
</pre></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">scAVENGERS</a></h1>








<h3>Navigation</h3>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Seungbeom Han.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/scAVENGERS modules/scAVENGERS cluster.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>